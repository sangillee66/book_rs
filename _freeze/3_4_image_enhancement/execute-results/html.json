{
  "hash": "76060efcea66065b20204c4a711c1f8a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"영상 강조\"\nauthor: Sang-Il Lee\ndate-modified: last-modified\nnumber-sections: true\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nlightbox: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n## 개요\n\n필수적인 패키지를 설치한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(terra)\nlibrary(tidyterra)\nlibrary(sf)\nlibrary(tmap)\noptions(scipen = 999)\n```\n:::\n\n\n서울의 행정구역 바운더리 파일을 불러온다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul <- st_read(\"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2023_2Q/SEOUL_SIDO_2023_2Q.shp\")\nseoul_gu <- st_read(\"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2023_2Q/SEOUL_GU_2023_2Q.shp\")\nseoul_dong <- st_read(\"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2023_2Q/SEOUL_EMD_2023_2Q.shp\")\n```\n:::\n\n\nLevel-2 데이터를 불러와 마스킹한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevel2_landsat_seoul_st <- rast(\"D:/My R/World Data Manupulation/USGS EarthExplorer/level2_landsat_seoul_stack.tif\")\nlevel2_landsat_seoul_st_mask <- level2_landsat_seoul_st |> \n  mask(seoul)\n```\n:::\n\n\n## 영상 축소 및 확대\n\n## 대비 확장(contrast stretching)\n\n### 최소-최대 대비 확장\n\n대비 확장을 실행한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevel2_landsat_seoul_st_mask_st_minmax <- level2_landsat_seoul_st_mask |> \n  stretch(minv = 0, maxv = 255)\n```\n:::\n\n\n히스토그램을 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_2 <- as.data.frame(level2_landsat_seoul_st_mask_st_minmax, xy = FALSE, na.rm = TRUE)\ndf_long <- df_2 |> \n  pivot_longer(\n    cols = everything(), names_to = \"band\", values_to = \"DN\"\n  ) |> \n  mutate(\n    band = fct(band, levels = unique(band))\n  )\nggplot(df_long, aes(x = DN)) +\n  geom_histogram(bins = 100) +\n  facet_wrap(~ band, scales = \"free_y\") +\n  theme(\n    plot.title = element_text(size = 30), \n    axis.title = element_text(size = 20),\n    axis.text.x = element_text(size = 16), \n    axis.text.y = element_text(size = 16),\n    legend.title = element_text(size = 17), \n    legend.text = element_text(size = 16),\n    strip.text = element_text(size = 20)\n  ) +\n  labs(\n    x = \"DN\", \n    y = \"Frequencies\", \n    caption =\"SANG-IL LEE, Geography Education at SNU, 2025\") \n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-5-1.png){width=11640}\n:::\n:::\n\n\n지도를 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(level2_landsat_seoul_st_mask_st_minmax, raster.downsample = FALSE) +\n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\") +\n  tm_facets(ncol = 4, free.scales = FALSE) +\n  tm_layout(legend.show = FALSE, panel.label.size = 2, \n            attr.outside = T, attr.outside.position = \"bottom\") +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 1.5, position = c(0.75, \"top\"))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-6-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### 표준편차 대비 확장\n\n[`RStoolbox`](https://bleutner.github.io/RStoolbox/) 패키지를 활용하여 모든 값을 표준화한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RStoolbox)\nlevel2_landsat_seoul_st_mask_z <- level2_landsat_seoul_st_mask |> \n  normImage(norm = TRUE)\n```\n:::\n\n\n대비 확장을 실행한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevel2_landsat_seoul_st_mask_st_std <- level2_landsat_seoul_st_mask_z |> \n  stretch(minv = 0, maxv = 255, smin = -2, smax = 2)\n```\n:::\n\n\n히스토그램을 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_2 <- as.data.frame(level2_landsat_seoul_st_mask_st_std, xy = FALSE, na.rm = TRUE)\ndf_long <- df_2 |> \n  pivot_longer(\n    cols = everything(), names_to = \"band\", values_to = \"DN\"\n  ) |> \n  mutate(\n    band = fct(band, levels = unique(band))\n  )\nggplot(df_long, aes(x = DN)) +\n  geom_histogram(bins = 100) +\n  facet_wrap(~ band, scales = \"free_y\") +\n  theme(\n    plot.title = element_text(size = 30), \n    axis.title = element_text(size = 20),\n    axis.text.x = element_text(size = 16), \n    axis.text.y = element_text(size = 16),\n    legend.title = element_text(size = 17), \n    legend.text = element_text(size = 16),\n    strip.text = element_text(size = 20)\n  ) +\n  labs(\n    x = \"DN\", \n    y = \"Frequencies\", \n    caption =\"SANG-IL LEE, Geography Education at SNU, 2025\") \n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-10-1.png){width=11640}\n:::\n:::\n\n\n지도를 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(level2_landsat_seoul_st_mask_st_std, raster.downsample = FALSE) +\n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\") +\n  tm_facets(ncol = 4, free.scales = FALSE) +\n  tm_layout(legend.show = FALSE, panel.label.size = 2, \n            attr.outside = T, attr.outside.position = \"bottom\") +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 1.5, position = c(0.75, \"top\"))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-11-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### 분위수 대비 확장\n\n대비 확장을 실행한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevel2_landsat_seoul_st_mask_st_prop <- level2_landsat_seoul_st_mask |> \n  stretch(minv = 0, maxv = 255, minq = 0.01, maxq = 0.99)\n```\n:::\n\n\n히스토그램을 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_2 <- as.data.frame(level2_landsat_seoul_st_mask_st_prop, xy = FALSE, na.rm = TRUE)\ndf_long <- df_2 |> \n  pivot_longer(\n    cols = everything(), names_to = \"band\", values_to = \"DN\"\n  ) |> \n  mutate(\n    band = fct(band, levels = unique(band))\n  )\nggplot(df_long, aes(x = DN)) +\n  geom_histogram(bins = 100) +\n  facet_wrap(~ band, scales = \"free_y\") +\n  theme(\n    plot.title = element_text(size = 30), \n    axis.title = element_text(size = 20),\n    axis.text.x = element_text(size = 16), \n    axis.text.y = element_text(size = 16),\n    legend.title = element_text(size = 17), \n    legend.text = element_text(size = 16),\n    strip.text = element_text(size = 20)\n  ) +\n  labs(\n    x = \"DN\", \n    y = \"Frequencies\", \n    caption =\"SANG-IL LEE, Geography Education at SNU, 2025\") \n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-14-1.png){width=11640}\n:::\n:::\n\n\n지도를 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(level2_landsat_seoul_st_mask_st_prop, raster.downsample = FALSE) +\n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\") +\n  tm_facets(ncol = 4, free.scales = FALSE) +\n  tm_layout(legend.show = FALSE, panel.label.size = 2, \n            attr.outside = T, attr.outside.position = \"bottom\") +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 1.5, position = c(0.75, \"top\"))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-15-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### 구간 대비 확장\n\n### 히스토그램 균등화(histogram equalization)\n\n대비 확장을 실행한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevel2_landsat_seoul_st_mask_st1_hist <- level2_landsat_seoul_st_mask |> \n  stretch(minv = 0, maxv = 255, histeq = TRUE)\n```\n:::\n\n\n히스토그램을 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_2 <- as.data.frame(level2_landsat_seoul_st_mask_st1_hist, xy = FALSE, na.rm = TRUE)\ndf_long <- df_2 |> \n  pivot_longer(\n    cols = everything(), names_to = \"band\", values_to = \"DN\"\n  ) |> \n  mutate(\n    band = fct(band, levels = unique(band))\n  )\nggplot(df_long, aes(x = DN)) +\n  geom_histogram(bins = 100) +\n  facet_wrap(~ band, scales = \"free_y\") +\n  theme(\n    plot.title = element_text(size = 30), \n    axis.title = element_text(size = 20),\n    axis.text.x = element_text(size = 16), \n    axis.text.y = element_text(size = 16),\n    legend.title = element_text(size = 17), \n    legend.text = element_text(size = 16),\n    strip.text = element_text(size = 20)\n  ) +\n  labs(\n    x = \"DN\", \n    y = \"Frequencies\", \n    caption =\"SANG-IL LEE, Geography Education at SNU, 2025\") \n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-18-1.png){width=11640}\n:::\n:::\n\n\n지도를 생성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(level2_landsat_seoul_st_mask_st1_hist, raster.downsample = FALSE) +\n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\") +\n  tm_facets(ncol = 4, free.scales = FALSE) +\n  tm_layout(legend.show = FALSE, panel.label.size = 2, \n            attr.outside = T, attr.outside.position = \"bottom\") +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 1.5, \n             position = c(0.75, \"top\"))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-19-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## 공간 필터링(spatial filtering)\n\n### 공간 영역 필터링\n\n관악구만을 대상으로 한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngwanak_gu <- seoul_gu |> \n  filter(SGG1_NM == \"관악구\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngwanak_5 <- level2_landsat_seoul_st |> crop(gwanak_gu) |>  mask(gwanak_gu) |> \n  stretch(minv = 0, maxv = 255, minq = 0.01, maxq = 0.99) |> select(`B5(NIR)`)\n```\n:::\n\n\n지도를 제작한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngwanak_5 |> plot(col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(gwanak_5, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Gwanak-gu: Band 5(NIR)\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-24-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### 로우패스(low pass, 저주파)\n\n`terra` 패키지의 `focal()` 함수를 적용하여 공간 필터링을 실행한다. 우선 가장 기본적인 로우패스(평균)를 적용한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlow_pass_mean <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, 1, 1, 1, 1, 1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(low_pass_mean, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(low_pass_mean, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Low Pass: Mean\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-28-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n로우패스(중위수)를 적용한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlow_pass_median <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, 1, 1, 1, 1, 1), nrow=3),\n    fun = median\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(low_pass_median, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(low_pass_median, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Low Pass: Median\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-32-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n로우패스(최소값)을 적용한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlow_pass_min <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, 1, 1, 1, 1, 1), nrow=3),\n    fun = min\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(low_pass_min, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(low_pass_min, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Low Pass: Minimum\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-36-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n로우패스(최대값)을 적용한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlow_pass_max <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, 1, 1, 1, 1, 1), nrow=3),\n    fun = max\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(low_pass_max, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(low_pass_max, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Low Pass: Maximum\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-40-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### 하이패스(high pass, 고주파)\n\n사례 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhigh_pass_1 <- gwanak_5 |> \n  focal(\n    w = matrix(c(-1, -1, -1, -1, 9, -1, -1, -1, -1), nrow=3), \n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(high_pass_1, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(high_pass_1, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"High Pass\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-44-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n사례 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhigh_pass_2 <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, -2, 1, -2, 5, -2, 1, -2, 1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(high_pass_2, col = grey(0:100/100))\n```\n:::\n\n\n엠보스 1(동서)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemboss_1 <- gwanak_5 |> \n  focal(\n    w = matrix(c(0, 0, 0, 1, 0, -1, 0, 0, 0), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(emboss_1, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(emboss_1, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Emboss EW\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-50-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n엠보스 2(남북)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemboss_2 <- gwanak_5 |> \n  focal(\n    w = matrix(c(0, 1, 0, 0, 0, 0, 0, -1, 0), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(emboss_2, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(emboss_2, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Emboss NS\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-54-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n엠보스 3(북동)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemboss_3 <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 0, 0, 0, 0, 0, 0, 0, -1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(emboss_3, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(emboss_3, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Emboss NE\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-58-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n엠보스 4(북서)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemboss_4 <- gwanak_5 |> \n  focal(\n    w = matrix(c(0, 0, 1, 0, 0, 0, -1, 0, 0), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(emboss_4, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(emboss_4, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Emboss NW\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-62-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n컴퍼스 경사 1(동)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompass_1 <- gwanak_5 |> \n  focal(\n    w = matrix(c(-1, 1, 1, -1, -2, 1, -1, 1, 1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(compass_1, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(compass_1, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Compass E\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-66-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n컴퍼스 경사 2(북)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompass_2 <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, -2, 1, -1, -1, -1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(compass_2, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(compass_2, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Compass N\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-70-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n컴퍼스 경사 3(북동)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompass_3 <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, -1, -2, 1, -1, -1, 1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(compass_3, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(compass_3, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Compass NE\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-74-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n컴퍼스 경사 4(북서)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompass_4 <- gwanak_5 |> \n  focal(\n    w = matrix(c(1, 1, 1, 1, -2, -1, 1, -1, -1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(compass_4, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(compass_4, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Compass NW\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-78-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n라플라스 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlaplace_4 <- gwanak_5 |>\n  focal(\n    w = matrix(c(0, -1, 0, -1, 4, -1, 0, -1, 0), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(laplace_4, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(laplace_4, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Laplacian 4\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-82-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n라플라스 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlaplace_5 <- gwanak_5 |>\n  focal(\n    w = matrix(c(0, -1, 0, -1, 5, -1, 0, -1, 0), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(laplace_5, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(laplace_5, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Laplacian 5\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-86-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n라플라스 7\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlaplace_7 <- gwanak_5 |>\n  focal(\n    w = matrix(c(1, 1, 1, 1, -7, 1, 1, 1, 1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(laplace_7, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(laplace_7, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Laplacian 7\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-90-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n라플라스 8\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlaplace_8 <- gwanak_5 |>\n  focal(\n    w = matrix(c(-1, -1, -1, -1, 8, -1, -1, -1, -1), nrow=3),\n    fun = mean\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(laplace_8, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(laplace_8, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Laplacian 8\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-94-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n소벨(Sobel) 필터는 우선 함수를 만든다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsobel <- function(r) {\n\tfx <- matrix(c(-1, 0, 1, -2, 0, 2, -1, 0, 1), nrow=3)\n\tfy <- matrix(c(1, 2, 1, 0, 0, 0, -1, -2, -1), nrow=3)\n\trx <- focal(r, fx)\n\try <- focal(r, fy)\n\tsqrt(rx^2 + ry^2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsobel <- gwanak_5 |>\n  sobel()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sobel, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(sobel, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Sobel\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-99-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n로버츠(Roberts) 필터는 우선 함수를 만든다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroberts <- function(r) {\n\tfx <- matrix(c(0, 0, 0, 0, 1, 0, 0, 0, -1), nrow=3)\n\tfy <- matrix(c(0, 0, 0, 0, 0, 1, 0, -1, 0), nrow=3)\n\trx <- focal(r, fx)\n\try <- focal(r, fy)\n\trx + ry\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroberts <- gwanak_5 |>\n  stretch(minv = 0, maxv = 255, minq = 0.01, maxq = 0.99) |> \n  roberts()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(roberts, col = grey(0:100/100))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_map <- tm_shape(roberts, raster.downsample = FALSE) + \n  tm_raster(style = \"cont\", palette = \"-Greys\", title = \"DN\", legend.show = FALSE) +\n  tm_shape(gwanak_gu) + tm_borders(col = \"black\", lwd = 2) +\n  # tm_legend(legend.position = c(0.87, 0.05), legend.bg.color = \"white\", legend.bg.alpha = 0.6, legend.title.size = 1.5, legend.text.size = 1.2) +\n  tm_layout(inner.margins = c(0.05, 0.04, 0.06, 0.04), \n            title = \"Roberts\", title.size = 2,\n            title.position = c(0.02, 0.97)) + \n  tm_scale_bar(breaks = seq(0, 2.5, 0.5), text.size = 0.6, color.dark = \"gray60\", \n               position = c(0.03, 0.01)) +\n  tm_credits(text = \"SANG-IL LEE, Geography Education at SNU, 2025\", size = 0.8, \n             position = c(0.76, 0.01))\nmy_map\n```\n\n::: {.cell-output-display}\n![](3_4_image_enhancement_files/figure-html/unnamed-chunk-104-1.png){width=4500}\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "3_4_image_enhancement_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}